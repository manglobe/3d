var Calendar=null;$(function(){Calendar=function(a){var e=new Date;var t=e.getFullYear();var r=e.getMonth();var n=e.getDate();var d=[t,r,n];var s=[];var i={CalendarLoad:null,el:"#calendarDate",top:true,startWeek:7,beforeDisabled:true,weeks:["周一","周二","周三","周四","周五","周六","周日"],ateOnClick:undefined,prevDay:true,nowDayCur:true,nowDayChecked:true,yearJump:false,daysOnClick:false,monthZero:true,headOnClick:undefined,changeDay:undefined,changeMonth:undefined,dateOnClick:undefined};var l={year:null,month:null,day:null,daysOn:null};function o(){$(".calendar,.date-cont").removeClass("on");$("body").removeClass("ovhide");$("#calendarLoad").remove()}$("#calendarDate").css({position:"relative","z-index":99});a.init=function(a,e){a=$.extend({},i,a);e=$.extend({},l,e);var t=$('<div class="calendar"></div>');var r=$('<div class="calendar-main"></div>');if(a.top){var n=v(a);$(a.el).append(n);t.height(window.innerHeight-40);t.click(function(){o()});r.click(function(a){a.stopPropagation()})}else{var d=h(a,e);var s=m(a,e);var c=u(a,e);r.append(d,s,c)}t.append(r);$(a.el).append(t)};a.refresh=function(a,e){argument=$.extend({},i,a);params=$.extend({},l,e);var t=h(argument,params);if($(".calendar-main").html()==""){var r=m(argument,params)}var n=u(argument,params);$("#calendarLoad").remove();if($(".calendar-main").html()==""){$(".calendar-main").append(t,r,n)}else{$(argument.el).find(".calendar-option").replaceWith(t);$(argument.el).find(".calendar-date").replaceWith(n)}};function v(a){var e=$('<div class="date-option"></div>');var i=$('<a class="days-prev"></a>');var l=$('<p class="date-text"><span class="date-cont">'+d[0]+"年"+(d[1]+1)+"月"+d[2]+"日</span></p>");var v=$('<a class="days-next"></a>');l.attr("date",d);if(a.monthZero){var h=d[1]+1<10?"0"+(d[1]+1):d[1]+1;var f=d[2]<10?"0"+d[2]:d[2];l.attr("dateformat",d[0]+"-"+h+"-"+f)}else{l.attr("dateformat",d[0]+"-"+(d[1]+1)+"-"+d[2])}s=[t,r,n];if(a.CalendarLoad){l=$('<p class="date-text"><span class="date-cont">'+a.CalendarLoad[0]+"年"+(a.CalendarLoad[1]+1)+"月"+a.CalendarLoad[2]+"日</span></p>");l.attr("date",a.CalendarLoad);s=[a.CalendarLoad[0],a.CalendarLoad[1],a.CalendarLoad[2]]}l.on("click",function(){if(!$("body").hasClass("ovhide")){var e=$(this).attr("date").split(",");var t=s=[parseInt(e[0]),parseInt(e[1]),parseInt(e[2])];if($(".calendar-date").find(".checked").attr("date")){if($(this).attr("date")!=$(".calendar-date").find(".checked").attr("date")){c();a.headOnClick(this,t)}}else{c();a.headOnClick(this,t)}}else{$("#calendarLoad").remove()}$(".calendar,.date-cont").toggleClass("on");$("body").toggleClass("ovhide")});i.on("click",function(){o();var e=p(this);$(".date-text").html('<span class="date-cont">'+e[0]+"年"+(e[1]+1)+"月"+e[2]+"日</span>");if(a.monthZero){var t=e[1]+1<10?"0"+(e[1]+1):e[1]+1;var r=e[2]<10?"0"+e[2]:e[2];$(".date-text").attr("dateformat",e[0]+"-"+t+"-"+r)}else{$(".date-text").attr("dateformat",e[0]+"-"+(e[1]+1)+"-"+e[2])}$(".date-text").attr("date",e);a.changeDay(this,e)});v.on("click",function(){o();var e=p(this);$(".date-text").html('<span class="date-cont">'+e[0]+"年"+(e[1]+1)+"月"+e[2]+"日</span>");if(a.monthZero){var t=e[1]+1<10?"0"+(e[1]+1):e[1]+1;var r=e[2]<10?"0"+e[2]:e[2];$(".date-text").attr("dateformat",e[0]+"-"+t+"-"+r)}else{$(".date-text").attr("dateformat",e[0]+"-"+(e[1]+1)+"-"+e[2])}$(".date-text").attr("date",e);a.changeDay(this,e)});e.append(i,l,v);return e}function c(){var a=$('<div id="calendarLoad" class="spinner">'+'<div class="bounce1"></div>'+'<div class="bounce2"></div>'+'<div class="bounce3"></div>'+"</div>");$("#calendarDate").append(a)}function p(a){var e=$(".date-text").attr("date").split(",");var t=[parseInt(e[0]),parseInt(e[1]),parseInt(e[2])];if($(a).hasClass("days-prev")){t[2]=t[2]-1;if(t[2]==0){var r=x(t[0],t[1]-1);t[2]=r;t[1]=t[1]-1;if(t[1]<0){t[1]=11;t[0]=t[0]-1}}}else{var n=x(t[0],t[1]);t[2]=t[2]+1;if(t[2]>n){t[2]=1;t[1]=t[1]+1;if(t[1]>11){t[1]=0;t[0]=t[0]+1}}}if(t[2]<d[2]&&t[1]==d[1]&&t[0]==d[0]){$(".days-prev").addClass("vhide")}else if(t[2]>d[2]&&t[1]<d[1]&&t[0]==d[0]){$(".days-prev").addClass("vhide")}else if(t[2]>d[2]&&t[1]>d[1]&&t[0]<d[0]){$(".days-prev").addClass("vhide")}else{$(".days-prev").removeClass("vhide")}return t}function h(a,e){var t=$('<div class="calendar-option"></div>');var r=$('<a class="year-prev"></a>');var n=$('<a class="year-next"></a>');var d=$('<a class="month-prev"></a>');var s=$('<a class="month-next"></a>');var i=$('<p class="calendar-text">'+e.year+"年"+(e.month+1)+"月"+"</p>");if(a.monthZero){var l=e.month+1<10?"0"+(e.month+1):e.month+1;i.attr("dateformat",e.year+"-"+l)}else{i.attr("dateformat",e.year+"-"+(e.month+1))}i.attr("date",[e.year,e.month]);d.click(function(){c();var e=f(this);a.changeMonth(this,e)});s.click(function(){c();var e=f(this);a.changeMonth(this,e)});a.yearJump&&t.append(r);t.append(d,i,s);a.yearJump&&t.append(n);return t}function f(a){var e=$(".calendar-text").attr("date").split(",");var t=[parseInt(e[0]),parseInt(e[1]),s[2]];if($(a).hasClass("month-prev")){t[1]=t[1]-1;if(t[1]<0){t[1]=11;t[0]=t[0]-1}}else{t[1]=t[1]+1;if(t[1]>11){t[1]=0;t[0]=t[0]+1}}return t}function m(a){var e=a.startWeek-1;var t=$('<ul class="calendar-week"></ul>');for(var r=e;r<=6;r++){var n=$("<li>"+a.weeks[r]+"</li>");if(r==5||r==6){n.addClass("week-rest")}t.append(n)}for(var d=0;d<e;d++){var n=$("<li>"+a.weeks[d]+"</li>");if(d==5||d==6){n.addClass("week-rest")}t.append(n)}return t}function u(a,e){var t=a.startWeek==7?0:1;var r=x(e.year,e.month);var n=D(e.year,e.month);var d=n==a.startWeek?r%7:(r+n-t)%7;var s=$('<ul class="calendar-date"></ul>');C(s,r,a,e);if(n!=a.startWeek){k(s,n-t,e)}if(d!=0){g(s,d)}return s}function C(a,e,t,r){for(var n=1;n<=e;n++){var i=new Date(r.year,r.month,n);var l=[r.year,r.month,n];var v=i.getDay();var c=$("<li></li>");var p=$("<span></span>");c.attr("date",l);if(t.monthZero){var h=l[1]+1<10?"0"+(l[1]+1):l[1]+1;var f=l[2]<10?"0"+l[2]:l[2];c.attr("dateformat",l[0]+"-"+h+"-"+f)}else{c.attr("dateformat",l[0]+"-"+(l[1]+1)+"-"+l[2])}if(t.beforeDisabled){if(n<d[2]&&r.month==d[1]&&r.year==d[0]){c.addClass("disabled")}if(r.year<d[0]){c.addClass("disabled")}if(r.month<d[1]&&r.year==d[0]){c.addClass("disabled")}}if(t.prevDay){if(n==d[2]-1&&r.month==d[1]&&r.year==d[0]){c.removeClass("disabled").addClass("day-prev")}if(d[2]==1&&r.month==d[1]-1&&r.year==d[0]&&n==e){c.removeClass("disabled").addClass("day-prev")}}if(t.nowDayCur){if(n==d[2]&&r.month==d[1]&&r.year==d[0]){c.addClass("cur")}}if(t.nowDayChecked){if(r.year==s[0]&&r.month==s[1]&&n==s[2]){c.addClass("checked")}}if(v==0||v==6){c.addClass("rest")}if(r.daysOn){for(var m in r.daysOn){if(t.monthZero){var h=l[1]+1<10?"0"+(l[1]+1):l[1]+1;var f=l[2]<10?"0"+l[2]:l[2];var u=l[0]+"-"+h+"-"+f}else{var u=l[0]+"-"+(l[1]+1)+"-"+l[2]}if(u==r.daysOn[m]&&!c.hasClass("disabled")){c.addClass("on")}}}p.html(n);c.append(p);if(t.dateOnClick){c.on("click",function(){if(!$(this).hasClass("disabled")){if(t.daysOnClick==true){if($(this).hasClass("on")){$(this).addClass("checked").siblings().removeClass("checked");var a=y(this);t.dateOnClick(this,a);$(".date-text").html('<span class="date-cont">'+a[0]+"年"+(a[1]+1)+"月"+a[2]+"日</span>");$(".date-text").attr("date",a);$(".date-text").attr("dateformat",a[0]+"-"+(a[1]+1)+"-"+a[2]);o();if(a[2]<d[2]&&a[1]==d[1]&&a[0]==d[0]){$(".days-prev").addClass("vhide")}else if(a[2]>d[2]&&a[1]<d[1]&&a[0]==d[0]){$(".days-prev").addClass("vhide")}else if(a[2]>d[2]&&a[1]>d[1]&&a[0]<d[0]){$(".days-prev").addClass("vhide")}else{$(".days-prev").removeClass("vhide")}}}else{$(this).addClass("checked").siblings().removeClass("checked");var a=y(this);t.dateOnClick(this,a);$(".date-text").html('<span class="date-cont">'+a[0]+"年"+(a[1]+1)+"月"+a[2]+"日</span>");$(".date-text").attr("date",a);$(".date-text").attr("dateformat",a[0]+"-"+(a[1]+1)+"-"+a[2]);o();if(a[2]<d[2]&&a[1]==d[1]&&a[0]==d[0]){$(".days-prev").addClass("vhide")}else if(a[2]>d[2]&&a[1]<d[1]&&a[0]==d[0]){$(".days-prev").addClass("vhide")}else if(a[2]>d[2]&&a[1]>d[1]&&a[0]<d[0]){$(".days-prev").addClass("vhide")}else{$(".days-prev").removeClass("vhide")}}}})}a.append(c)}return a}function y(a){var e=$(a).attr("date").split(",");var t=[parseInt(e[0]),parseInt(e[1]),parseInt(e[2])];return t}function k(a,e,t){var r=t.month-1<0?0:t.month-1;var n=x(t.year,r);for(var d=0;d<e;d++){var s=$('<li class="disabled"></li>');var i=$("<span> </span>");s.append(i);a.prepend(s)}return a}function g(a,e){for(var t=1;t<=7-e;t++){var r=$('<li class="disabled"></li>');var n=$("<span> </span>");r.append(n);a.append(r)}return a}function x(a,e){e=parseInt(e,10)+1;var t=new Date(a,e,0);cur_month_days=t.getDate();return cur_month_days}function D(a,e){var t=new Date(a,e,1);cur_month_week=t.getDay();cur_month_week=cur_month_week==0?7:cur_month_week;return cur_month_week}return a}(this)});